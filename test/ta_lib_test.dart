import 'package:ta_lib/ta_lib.dart';
import 'package:test/test.dart';

void main() {
  group('TA-Lib', () {
    final taLib = TaLib();

    // setUp(() {
    //   // Additional setup goes here.
    // });

    test('MA', () {
      expect(taLib.ma(1, 4, [1, 2, 3, 4, 5], maType: MaType.sma, timePeriod: 3),
          [2, 3, 4]);
    });

    test('MACD', () {
      final (:macd, :macdSignal, :macdHist) = taLib.macd(
        1,
        40,
        [
          818724.000,
          821250.000,
          819260.000,
          819282.000,
          819765.000,
          820000.000,
          819500.000,
          820000.000,
          820000.000,
          820301.000,
          821388.000,
          819546.000,
          820441.000,
          821528.000,
          820928.000,
          820032.000,
          819646.000,
          819647.000,
          820250.000,
          820258.000,
          821337.000,
          820213.000,
          821369.000,
          821369.000,
          820245.000,
          821332.000,
          820305.000,
          821392.000,
          820290.000,
          821530.000,
          821530.000,
          820244.000,
          820286.000,
          819648.000,
          819646.000,
          819648.000,
          819850.000,
          819648.000,
          819647.000,
          819646.000,
        ],
      );
      expect(macd, [
        97.60097619506996,
        19.785526246996596,
        -41.24692629056517,
        -72.48036430391949,
        -112.23897967848461,
        -142.18958739726804,
        -164.11454116669483,
        -65564.2880571835,
      ]);
      expect(macdHist, [
        -139.410705354802,
        -173.78092424230027,
        -187.85070142388963,
        -175.26731154979515,
        -172.02074153948823,
        -161.57707940661732,
        -146.8016265408353,
        -52437.58011404611,
      ]);
      expect(
        macdSignal,
        [
          237.01168154987195,
          193.56645048929687,
          146.60377513332446,
          102.78694724587567,
          59.78176186100361,
          19.387492009349273,
          -17.31291462585955,
          -13126.707943137388
        ],
      );
    });
  });
}
